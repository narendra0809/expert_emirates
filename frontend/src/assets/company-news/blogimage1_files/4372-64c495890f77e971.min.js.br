"use strict";
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="135f8075-4165-5901-82fd-bace39f82a97")}catch(e){}}();
(globalThis.webpackChunk_figma_web_bundler=globalThis.webpackChunk_figma_web_bundler||[]).push([[4372],{166178:(e,t,n)=>{n.d(t,{$S:()=>i,D5:()=>l,HL:()=>o,KD:()=>a,Qi:()=>r});let o="feed_reactions_section--reactionPill--qE8nJ reactions--reaction--BGfYE text--fontPos11--2LvXf text--_fontBase--QdLsd",a="feed_reactions_section--reactionList---Yu5e",i="feed_reactions_section--addReactionButton--0D-O4",r="feed_reactions_section--addReactionButtonSelected--OU1gq",l="feed_reactions_section--addReactionButtonOnly--9t-4W"},212073:(e,t,n)=>{n.d(t,{J:()=>l,k:()=>s});var o=n(314979),a=n(967688),i=n(210853),r=n(151223);let l=(0,r.nF)((e,t)=>{let{receiptsAPI:n,comment:r}=t;n.markAsUnread(r.uuid).catch(t=>{let n=(0,a.t)("whiteboard.an_error_occurred_while_marking_a_canvas_mention_as_unread");try{t=JSON.parse(t),e.dispatch(o.s.error((0,i.J)(t,n)))}catch(t){e.dispatch(o.s.error(n))}})}),s=(0,r.nF)((e,t)=>{let{receiptsAPI:n,thread:r}=t,l=r.comments.map(e=>e.uuid).filter(e=>!!e);n.markAsRead(l).catch(t=>{let n=(0,a.t)("whiteboard.an_error_occurred_while_marking_a_canvas_mention_as_read");try{t=JSON.parse(t),e.dispatch(o.s.error((0,i.J)(t,n)))}catch(t){e.dispatch(o.s.error(n))}})})},711332:(e,t,n)=>{n.d(t,{h:()=>l});var o=n(848318),a=n(967688),i=n(446951),r=n(414607);let l=(0,i.Ju)(function(e){return o.createElement(r.Rw,{destructive:!0,confirmationTitle:"Delete comment",confirmText:"Delete",onConfirm:e.onConfirm,popStack:e.popStack},o.createElement("p",null,(0,a.tx)("comments.are_you_sure_you_want_to_delete_this_comment_this_action_cannot_be_undone")))},"CommentConfirmDeleteModal")},482663:(e,t,n)=>{n.d(t,{g:()=>a});var o=n(848318);function a(e,t,n){(0,o.useLayoutEffect)(()=>{if(!e||!e.current)return;let o=new IntersectionObserver(n=>{for(let o of n)e.current===o.target&&t?.(o)},n);return o.observe(e.current),()=>o.disconnect()},[e,t,n])}},975796:(e,t,n)=>{n.d(t,{K:()=>v,R:()=>C});var o=n(848318),a=n(301168),i=n(865114),r=n(156974),l=n(967688),s=n(212073),d=n(847461),c=n(453370),m=n(31898),u=n(691784),f=n(431698),p=n(730143),_=n(125761),h=n(302982),g=n(711332),E=n(335744);let v=e=>`COMMENT_SIDEBAR_OVERFLOW_DROPDOWN-${e}`;function C(e){let{thread:t,targetRect:n,isUnread:v,copyLink:C,onDeleteThread:b}=e,{commentReceipts:T}=(0,f.I_)(),w=(0,u.fr)(),I=(0,a.wA)(),P=(0,p.tS)(),y=(0,_.TA)(),k=(0,i.ZC)(n),x=o.useCallback(()=>{I(c.oB())},[I]);o.useEffect(()=>{k&&(n.top!==k.top||n.left!==k.left)&&x()},[n,k,x]);let U=o.useCallback(()=>{T&&(v?I(d.AY({receiptsAPI:T,thread:t})):I(d.QY({receiptsAPI:T,comment:t.comments[0]})))},[T,I,v,t]),M=o.useCallback(()=>{w&&(v?I(s.k({receiptsAPI:w,thread:t})):I(s.J({receiptsAPI:w,comment:t.comments[0]})))},[w,I,v,t]),O=o.useCallback(()=>{C(t.comments[0])},[C,t]),N=o.useCallback(()=>{let e=b?()=>b(t):()=>I(d.Mv({comment:t.comments[0]}));I((0,m.to)({type:g.h,data:{onConfirm:e}}))},[I,b,t]),L=o.useMemo(()=>{if(y===t.comments[0].user_id&&!t.isCanvasMention&&(0,h.m)(t.sidebarItemType))return o.createElement(r.c$,{onClick:N},(0,l.tx)("comments.delete_thread"))},[t,y,N]),S=o.useMemo(()=>{let e=[];return w&&P&&t.isCanvasMention?e.push(o.createElement(r.c$,{onClick:M},v?(0,l.tx)("comments.mark_as_read"):(0,l.tx)("comments.mark_as_unread"))):T&&P&&!t.isCanvasMention&&(0,h.m)(t.sidebarItemType)&&e.push(o.createElement(r.c$,{onClick:U},v?(0,l.tx)("comments.mark_as_read"):(0,l.tx)("comments.mark_as_unread"))),e.push(o.createElement(r.c$,{onClick:O},(0,l.tx)("comments.copy_link"))),L&&e.push(L),e},[T,w,P,O,L,t.isCanvasMention,t.sidebarItemType,M,U,v]);return o.createElement(E.Jz,{showPoint:!0,targetRect:n,minWidth:160,options:S,hideDropdown:x,autofocusPrevElementOnSelect:!0,autofocusPrevElementOnEsc:!0,autofocusPrevElementOnTab:!0,propagateCloseClick:!0})}},660037:(e,t,n)=>{n.d(t,{u:()=>T});var o=n(848318),a=n(762217),i=n(359822),r=n(615233),l=n(967688),s=n(957872),d=n(30575),c=n(34542),m=n(263336),u=n(45937),f=n(391301),p=n(370715),_=n(175393),h=n(371560),g=n(837932),E=n(136169),v=n(944239),C=n(721014);let b=(0,v.n)(()=>m.N.SECONDARY_MODAL);function T({registrationOrigin:e,fixedPositionProps:t}){let n=(0,d.I1)(h.d.isBrowserNotificationSupported()),{complete:m,isShowing:v,show:T}=(0,c.e)({overlay:E.ueY,priority:b(),experiment:{check:n.browserNotificationConfig,predicate:e=>e,postCheck:()=>!0}});(0,i.h)(()=>{(async()=>{let e=await h.d.getPermissionPreference();T({canShow:()=>"prompt"===e.state})})()}),o.useEffect(()=>{t?.setIsShowingOverlay?.(v)},[v,t]);let w=()=>{h.d.requestPushNotifications(e,n)},{calloutTitle:I,mediaPath:P,targetKey:y,arrowPosition:k}=function(e){let t,n,o,a;switch(e){case g.iX.NEW_COMMENT:t=(0,l.tx)("browser_notifications.onboarding_overlay.title.replies"),n=C.qH,o=C.UU,a=_.F_.BOTTOM;break;case g.iX.COMMENT_REPLY:t=(0,l.tx)("browser_notifications.onboarding_overlay.title.replies"),n=C.qH,o=C.ym,a=_.F_.TOP_RIGHT;break;default:t=(0,l.tx)("browser_notifications.onboarding_overlay.title.activity"),n=C.vH,o=C.fD,a=_.F_.TOP_RIGHT}return{calloutTitle:t,mediaPath:n,targetKey:o,arrowPosition:a}}(e),x={clickOutsideToHide:!0,description:(0,l.tx)("browser_notifications.onboarding_overlay.description"),disableHighlight:!0,forceUI3Theme:!0,isShowing:v,media:o.createElement(u.y,{alt:(0,l.t)("browser_notifications.onboarding_overlay.media.alt"),aspectRatio:C.mk,src:(0,r.ck)(P)}),onClose:m,primaryCta:{ctaTrackingDescriptor:s.c.NEXT,label:(0,l.tx)("browser_notifications.onboarding_overlay.primary_cta"),onClick:()=>{w(),m()},type:"button"},secondaryCta:{ctaTrackingDescriptor:s.c.CLOSE,label:(0,l.tx)("browser_notifications.onboarding_overlay.secondary_cta"),onClick:m,type:"button"},shouldHideArrow:!0,title:I,trackingContextName:"Browser Notifications Onboarding",width:C.V_,zIndex:p.R.MODAL};return o.createElement(a.o,{eventListeners:["onClick","onMouseDown"]},t?.targetLocation?o.createElement(f.rq,{...x,fixedPosition:!0,location:t.targetLocation,innerRef:t.innerRef}):o.createElement(f.rq,{...x,arrowPosition:k,targetKey:y}))}},271762:(e,t,n)=>{n.d(t,{V:()=>c});var o=n(848318),a=n(967688),i=n(523669),r=n(511067),l=n(17753),s=n(335744),d=n(16808);function c(e){let t=(0,r.BK)(e.dropdownId),n=o.useRef(null),c=o.useRef(null);if(o.useEffect(()=>{t.showing&&c.current&&c.current.focus()},[t.showing]),e.hideTarget&&!t.showing)return null;let m=e.children;return m||(m=o.createElement(d.YW,{style:t.showing?{backgroundColor:"var(--color-bg-hover, var(--fallback-color-bg-hover))"}:void 0,selected:t.showing,"data-tooltip-type":l.Ib.TEXT,"data-tooltip":(0,a.t)("fig_feed.more_actions"),onClick:e=>{e.stopPropagation(),t.toggle()}},o.createElement(i.In,{icon:"dots-32"}))),o.createElement("div",null,o.createElement("div",{ref:n,onMouseDown:e=>e.stopPropagation()},m),n.current&&t.showing&&o.createElement(s.Jz,{closeDropdown:t.hide,displayAboveTarget:e.displayAboveTarget,displayOverTarget:e.displayOverTarget,hideDropdown:t.hide,lean:e.lean,maxHeight:e.maxHeight,maxWidth:e.maxWidth,minWidth:e.minWidth,options:e.options,propagateCloseClick:!0,showPoint:!1,targetRect:n.current.getBoundingClientRect(),textAlign:e.textAlign}))}},483337:(e,t,n)=>{n.d(t,{x:()=>ei});var o=n(848318),a=n(660376),i=n(536384),r=n.n(i),l=n(539149),s=n(206639),d=n(459633),c=n(214014),m=n(50429),u=n(720522),f=n(967688),p=n(560596),_=n(163699),h=n(983912),g=n(17753),E=n(524767),v=n(140691);function C(){return o.createElement("svg",{width:"18",height:"18",viewBox:"0 0 18 18",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{d:"M1 9C1 4.58172 4.58172 1 9 1C13.4183 1 17 4.58172 17 9C17 13.4183 13.4183 17 9 17C4.58172 17 1 13.4183 1 9Z",fill:"var(--color-icon)"}),o.createElement("path",{d:"M9 16.25C4.99594 16.25 1.75 13.0041 1.75 9H0.25C0.25 13.8325 4.16751 17.75 9 17.75V16.25ZM16.25 9C16.25 13.0041 13.0041 16.25 9 16.25V17.75C13.8325 17.75 17.75 13.8325 17.75 9H16.25ZM9 1.75C13.0041 1.75 16.25 4.99594 16.25 9H17.75C17.75 4.16751 13.8325 0.25 9 0.25V1.75ZM9 0.25C4.16751 0.25 0.25 4.16751 0.25 9H1.75C1.75 4.99594 4.99594 1.75 9 1.75V0.25Z",fill:"var(--color-icon-oninverse)"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.1554 8.44833L11.6037 6L12.3108 6.7071L9.86251 9.15544L12.3108 11.6038L11.6037 12.3109L9.15541 9.86255L6.70711 12.3109L6 11.6038L8.4483 9.15544L6 6.70715L6.70711 6.00004L9.1554 8.44833Z",fill:"var(--color-icon-oninverse)"}))}var b=n(772129),T=n(345964),w=n(244979);function I(e){let[t,n]=o.useState(),[a,i]=o.useState(!0);return o.useEffect(()=>{let t=(0,w.lD)({hideUI:!0,disableDefaultKeyboardNav:!1,showProtoSidebar:!1,scalingInfo:{viewportScalingMode:"contain"},showHotspots:!0,inlinePreview:!1,startingPointNodeId:e.item.startingNodeId,nodeId:e.item.startingNodeId}),o=(0,E.OQ)(e.item,t);n(`${location.origin}/embed?embed_host=feed&url=${encodeURIComponent(o)}`)},[e.item]),o.createElement("div",{style:{width:"100%",height:"100%",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"black"}},a&&o.createElement(T.kt,null),t?o.createElement("iframe",{title:"Prototype Viewer",style:a?{width:0,height:0}:{width:"100%",height:"100%"},src:t,onLoad:()=>i(!1)}):null)}var P=n(999667),y=n(865114),k=n(238462),x=n(960565),U=n(482663),M=n(871455);let O=e=>e.preventDefault(),N=(0,P.eU)(null),L=(0,P.eU)(new Map),S=(0,P.eU)(null,(e,t,n)=>{t(L,new Map(e(L).set(n.id,n.snapshot)))}),A=(0,P.eU)(new Set),D=(0,P.eU)(e=>{let t=e(A);return 0===t.size?null:Array.from(t).pop()??null}),R=(0,P.eU)(null);function B(e){let t=o.useRef(null),[n,a,i]=(0,d.M)(),l=o.useRef(null),s=o.useRef(!1),c=o.useRef(!1),m=o.useRef(!1),[f,p]=(0,P.fp)(N),[h,g]=o.useState(),v=(0,P.fp)(L)[0],C=(0,P.fp)(S)[1],[b,T]=(0,P.fp)(A),w=(0,P.md)(D),[I,B]=(0,P.fp)(R),H=f?.id===e.id,V=e.source===E.Zp.TILE&&!e.isThumbnail,Z=V&&(null==f||f.isPreviewing),z=!e.isThumbnail&&a,W=V||e.isThumbnail,Y=c.current,{feedPostUuid:G}=e,$=_.cU.includes(e.videoContent.mediaType)&&!!G,J=o.useMemo(()=>$?`/api/feed_posts/${G}/videos/${e.videoContent.videoFileUuid}/manifest`:e.videoContent.path,[$,G,e.videoContent]),Q=(0,y.ZC)(f),j=(0,y.ZC)(e.videoContent.path),K=o.useCallback((t,n=!1)=>{e.isThumbnail||C({id:e.id,snapshot:{currentTime:n?0:t.currentTime,ended:t.ended,paused:t.paused}})},[C,e.id,e.isThumbnail]),X=o.useCallback(()=>{c.current=!0;let e=t.current;e&&(e.muted=!0,e.play().catch(k.lQ))},[]),q=o.useCallback(()=>{let e=t.current;e&&e.pause()},[]),ee=o.useCallback(()=>{p({id:e.id,ref:t,feedPostUuid:e.feedPostUuid,src:e.videoContent.path,source:e.source,isPreviewing:c.current})},[p,e.id,e.feedPostUuid,e.videoContent.path,e.source,c]),et=o.useCallback(()=>{if(!f)return;let n=t.current;if(n){if(!H){let t=f.feedPostUuid===e.feedPostUuid&&f.src===e.videoContent.path;if(e.source===E.Zp.DETAIL_MODAL&&f.source===E.Zp.TILE&&t){if(n){if(f.ref?.current){let e=f.ref.current;n.currentTime=e.ended?0:e.currentTime,e.paused?ee():n.play()}else{let e=F(f.feedPostUuid,f.src,E.Zp.TILE),t=v.get(e);t&&(n.currentTime=t.ended?0:t.currentTime),ee()}}}else if(e.source===E.Zp.TILE&&f.source===E.Zp.DETAIL_MODAL&&t){if(n&&!f.ref?.current){let e=F(f.feedPostUuid,f.src,E.Zp.DETAIL_MODAL),t=v.get(e);t&&(n.currentTime=t.currentTime||0),ee()}else n.pause()}else if(n.paused){let t=v.get(e.id);t&&(n.currentTime=t.ended?0:t.currentTime)}else n.pause()}if(H&&v.has(e.id)&&!f.ref?.current){let n=v.get(e.id);if(t.current){if(t.current.currentTime=n.ended?0:n.currentTime,n.paused)return;t.current.play()}}}},[f,e.id,e.source,v,ee,e.feedPostUuid,e.videoContent.path,H]),en=o.useCallback(()=>{let n=t.current;n&&e.source===E.Zp.DETAIL_MODAL&&!e.isThumbnail&&n.play().catch(()=>{n.muted=!0,n.play()})},[e.isThumbnail,e.source]),eo=o.useCallback(t=>{let n=b.has(e.id);Z&&t.isIntersecting&&!c.current&&!n?(X(),null!=e.feedPostIdx&&(null===I||I>e.feedPostIdx)&&B(t=>null!=e.feedPostIdx&&(null===t||t>e.feedPostIdx)?e.feedPostIdx:t),T(t=>{let n=new Set(t);return n.add(e.id),n})):!t.isIntersecting&&n&&(q(),T(t=>{let n=new Set(t);return n.delete(e.id),n}),H&&p(null))},[X,q,e.id,e.feedPostIdx,T,Z,b,H,p,I,B]);(0,U.g)(i,eo,{threshold:.9}),o.useEffect(()=>{Z&&w===e.id&&X()},[w,X,e.id,Z]),o.useEffect(()=>{let n=t.current;if(!n)return;let o=()=>{ee(),K(n)},a=()=>{if(c.current)c.current=!1,n.currentTime=0;else{let e=t.current;e&&K(e)}},i=()=>{let e=t.current;if(e){let t=e.duration-e.currentTime;t!==h&&g(t)}},r=()=>{i()},l=()=>{!m.current&&(m.current=!0,W&&t.current&&(t.current.muted=!0),Z&&I===e.feedPostIdx&&X())};return n.addEventListener("play",o),n.addEventListener("pause",a),n.addEventListener("timeupdate",i),n.addEventListener("loadedmetadata",r),n.addEventListener("canplay",l),()=>{n.removeEventListener("play",o),n.removeEventListener("pause",a),n.removeEventListener("timeupdate",i),n.removeEventListener("loadedmetadata",r),n.removeEventListener("canplay",l)}},[ee,K,X,q,c,h,W,Z,I,e.id,e.feedPostIdx]),o.useEffect(()=>{let n=t.current;if(n)return()=>{K(n,e.source===E.Zp.TILE)}},[K,e.source]),o.useEffect(()=>{s.current||(s.current=!0,async function(){window.VIDEOJS_NO_DYNAMIC_STYLE=!0;let n=await (0,x.Fe)();if(l.current)return;let o=t.current;e.isThumbnail?o.style.objectFit="cover":(o.style.maxHeight="100%",o.style.maxWidth="100%"),o.style.height="100%",o.style.width="100%",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",l.current=n.videoJs(o,{muted:!1,controls:!1,controlBar:!1,bigPlayButton:!1,loadingSpinner:!1,errorDisplay:!1,textTrackSettings:!1,textTrackDisplay:!1,nativeTextTracks:!1},()=>{e.isThumbnail||e.source===E.Zp.TILE||o.setAttribute("controls","true"),e.source===E.Zp.TILE&&o.classList.add("feed_video_player--hideFullscreenControl--C1EYT"),(0,x.uz)(J,$,l.current).then(()=>{et()})})}())},[e.isThumbnail,e.videoContent,e.source,$,J,et]),o.useEffect(()=>{l.current&&j!==e.videoContent.path&&(0,x.uz)(J,$,l.current).then(()=>{et(),ee()})},[et,e.videoContent,$,J,j,ee]),o.useEffect(()=>{if(l.current&&Q&&f){if("detail"===f.source&&!f.ref?.current){et();return}Q.id!==f.id&&et()}},[et,Q,f]);let ea=o.useCallback(()=>{if(e.isThumbnail||e.source!==E.Zp.TILE||!t.current||void 0===h||isNaN(h))return null;let n=new Date(1e3*h);return!n||isNaN(n.getTime())?null:o.createElement(o.Fragment,null,o.createElement("div",{className:"feed_video_player--mediaBadgeV2--fvyMQ feed_post_content--mediaBadgeV2--7Akie feed_tile--feedPostHoverContainer--238j6"},n.toLocaleString("en",{minute:"2-digit",second:"2-digit"})),t.current.muted&&o.createElement(u.B,{svg:M.A,className:"feed_video_player--mutedBadge--K8Mfa"}))},[e.isThumbnail,e.source,h]);return o.createElement("div",{ref:n,className:r()("feed_video_player--videoContainer--L740O",e.isThumbnail&&"feed_video_player--videoContainerThumbnail--p1UBT")},o.createElement("video",{ref:t,style:{backgroundColor:"#000000"},onCanPlay:en,onClick:e.source!==E.Zp.DETAIL_MODAL?O:void 0,controls:z,loop:Y}),(!a||!z)&&ea())}function F(e,t,n){return[e,t,n].join(":")}let H="feed_post_content--mediaBadgeV2--7Akie feed_tile--feedPostHoverContainer--238j6",V="feed_post_content--contentThumbnailsSectionInnerV2--26v-c",Z="feed_post_content--contentThumbnailsSectionInnerV2_vertical--ysuGr",z="feed_post_content--contentThumbnailV2--o2ggD",W="feed_post_content--smallThumbnail--0trZ9",Y="feed_post_content--wideThumbnail--FPYj1";var G=n(954184),$=n(342635);function J(e){let t;switch(e.type){case h.cM.NODE:t=e.nodeId;break;case h.cM.IMAGE:t=e.url;break;case h.cM.VIDEO:t=e.path;break;case h.cM.PROTOTYPE:t=e.startingNodeId;break;default:throw Error("unexpected content item type")}return`${e.type}:${t}`}function Q(e){let[t,n]=o.useState(!e.isThumbnail&&!e.usesPreviewImage);if(o.useEffect(()=>{if(!e.imgUrl)return;let t=new Image;t.src=e.imgUrl,t.onload=()=>{let e=t.width/t.height;n(t=>t&&Math.abs(e-b.dp)>.01)}},[e.imgUrl]),null===e.imgUrl)return o.createElement("div",null,(0,f.t)("fig_feed.could_not_load_preview_image"));let a=e.isThumbnail&&e.thumbnailUrl?e.thumbnailUrl:e.imgUrl;return o.createElement(o.Fragment,null,e.showPreviewFacade&&o.createElement("div",{className:"feed_post_content--previewFacadeOverlay--EXG86 feed_post_content--thumbnailOverlay--feEzZ"},o.createElement(c.pz,{onClick:e.onUpdatePreviewImage},(0,f.t)("fig_feed.update_preview_image"))),o.createElement("img",{src:a,alt:(0,f.t)("fig_feed.thumbnail_alt_text"),draggable:!1,className:r()("feed_post_content--itemImage--pGodc",e.isThumbnail&&"feed_post_content--itemImageThumbnail--LBdlC",t&&"feed_post_content--itemImagePadded--exY8B")}),e.isThumbnail?null:"image/gif"===e.mediaType?o.createElement("div",{className:H},(0,f.t)("fig_feed.gif")):null)}function j(e){let t=!!e.editPreviewOptions;return o.createElement("div",{className:"feed_post_content--zoomPanContainer--IGM49"},e.contentItems.map((n,a)=>{let i;return e.editPreviewOptions?.applyToAllCallback&&(i=t=>e.editPreviewOptions.applyToAllCallback(t,J(n))),o.createElement("div",{key:a,className:r()({"feed_post_content--zoomPan--T-44S":!0,"feed_post_content--zoomPanSelected--2QOfW":a===e.selectedIdx})},o.createElement(b.DH,{key:`details::${n.image_url}`,applyToAllCallback:i,disableReset:!!e.editPreviewOptions?.disableReset,enableSnapToGuidelines:t,enableZoomControls:e.source===E.Zp.DETAIL_MODAL,enableZoomKeyControls:a===e.selectedIdx&&(e.source===E.Zp.DETAIL_MODAL||t),imageScale:t?1:void 0,imageSrc:n.image_url,initialSnapshotState:e.editPreviewOptions?.initialSnapshotStates?.[J(n)],pageBackgroundColor:e.editPreviewOptions?.pageBackgroundColor||n.backgroundColor&&(0,s.H0)(n.backgroundColor)||e.pageBackgroundColor&&(0,s.H0)(e.pageBackgroundColor)||void 0,resetSnapshotState:e.editPreviewOptions?.selectedContentResetSnapshotState,setContentPreview:a===e.selectedIdx?e.editPreviewOptions?.setContentPreview:void 0,shouldWheelPan:!0,shouldZoomToStart:!1,showEditPreviewControls:t}))}))}function K(e){return o.createElement(I,{item:e.prototypeContent})}function X(e){let t=!!e.editPreviewOptions;return o.createElement(b.DH,{key:`details::${e.imageContent.url}`,applyToAllCallback:e.editPreviewOptions?.applyToAllCallback?t=>e.editPreviewOptions.applyToAllCallback(t,J(e.imageContent)):void 0,disableReset:!!e.editPreviewOptions?.disableReset,enableSnapToGuidelines:t,enableZoomControls:e.source===E.Zp.DETAIL_MODAL,enableZoomKeyControls:e.source===E.Zp.DETAIL_MODAL||t,imageScale:1,imageSrc:e.imageContent.url,initialSnapshotState:e.editPreviewOptions?.initialSnapshotStates?.[J(e.imageContent)],pageBackgroundColor:e.editPreviewOptions?.pageBackgroundColor||e.imageContent.backgroundColor&&(0,s.H0)(e.imageContent.backgroundColor)||e.pageBackgroundColor&&(0,s.H0)(e.pageBackgroundColor)||void 0,resetSnapshotState:e.editPreviewOptions?.selectedContentResetSnapshotState,setContentPreview:e.editPreviewOptions?.setContentPreview,shouldWheelPan:!0,shouldZoomToStart:!1,showEditPreviewControls:t})}function q(e){let t=F(e.feedPostUuid,e.videoContent.path,e.source);return o.createElement(B,{id:t,videoContent:e.videoContent,isThumbnail:e.isThumbnail,feedPostUuid:e.feedPostUuid,source:e.source})}function ee(e){return e.isThumbnail?o.createElement("div",null,(0,f.tx)("fig_feed.video")):o.createElement("div",null,(0,f.tx)("fig_feed.transcode_after_submit"))}function et(e){if(_.cU.includes(e.videoContent.mediaType)&&""===e.videoContent.videoFileUuid)return o.createElement(ee,{isThumbnail:e.isThumbnail});if(e.isThumbnail&&e.videoContent.coverImage)return o.createElement(Q,{imgUrl:e.videoContent.coverImage,isThumbnail:!0});let t=F(e.feedPostUuid,e.videoContent.path,e.source);return o.createElement(B,{id:t,videoContent:e.videoContent,isThumbnail:e.isThumbnail,feedPostUuid:e.feedPostUuid,feedPostIdx:e.feedPostIdx,source:e.source})}function en(e){return o.createElement(o.Fragment,null,o.createElement(m.x,{isLoading:!e.content.imageUrl},()=>o.createElement(Q,{imgUrl:e.content.imageUrl,isThumbnail:e.isThumbnail})),!e.isThumbnail&&o.createElement("div",{className:H},(0,f.tx)("fig_feed.prototype_badge")))}function eo(e){let t=e.contentItems[e.selectedIdx];switch(t.type){case h.cM.NODE:return o.createElement(j,{selectedIdx:e.selectedIdx,contentItems:e.contentItems,editPreviewOptions:e.editPreviewOptions,pageBackgroundColor:e.pageBackgroundColor,source:e.source});case h.cM.IMAGE:return o.createElement(X,{imageContent:t,source:e.source,editPreviewOptions:e.editPreviewOptions,pageBackgroundColor:e.pageBackgroundColor});case h.cM.VIDEO:return o.createElement(q,{videoContent:t,isThumbnail:!1,feedPostUuid:e.feedPostUuid,source:e.source});case h.cM.PROTOTYPE:return o.createElement(K,{prototypeContent:t});default:(0,a.xb)(t)}}function ea(e){switch(e.content.type){case h.cM.NODE:let t=e.content,n=t.mediumImageUrl??t.preview_image_url??t.image_url,i=t.preview_image_url??t.image_url;return o.createElement(m.x,{isLoading:!!t.isLoading},()=>o.createElement(Q,{imgUrl:e.isEditing?i:n,usesPreviewImage:!!t.preview_image_url,isThumbnail:e.isThumbnail,thumbnailUrl:e.isEditing?i:t.thumbnailUrl,showPreviewFacade:e.showPreviewFacade,onUpdatePreviewImage:e.onUpdatePreviewImage}));case h.cM.IMAGE:let r=e.content.mediumImageUrl??e.content.preview_image_url??e.content.url,l=e.content.preview_image_url??e.content.url;return o.createElement(Q,{imgUrl:e.isEditing?l:r,isThumbnail:e.isThumbnail,usesPreviewImage:!!e.content.preview_image_url,mediaType:e.content.mediaType,thumbnailUrl:e.isEditing?l:e.content.thumbnailUrl,showPreviewFacade:e.showPreviewFacade,onUpdatePreviewImage:e.onUpdatePreviewImage});case h.cM.VIDEO:return o.createElement(et,{videoContent:e.content,isThumbnail:e.isThumbnail,feedPostUuid:e.feedPostUuid,feedPostIdx:e.feedPostIdx,source:e.source});case h.cM.PROTOTYPE:return o.createElement(en,{content:e.content,isThumbnail:e.isThumbnail});default:(0,a.xb)(e.content)}}function ei(e){let t=!!e.editPreviewOptions,n=e.contentItems.length>1||t,{selectedContentIdx:a,pageBackgroundColor:i,setSelectedContentIdx:l,contentItems:c,onContentHover:p}=e,[_,E]=(0,d.M)();o.useEffect(()=>{p?.(E)},[E,p]);let C=o.useMemo(()=>c[a],[c,a]),b=o.useMemo(()=>n?o.createElement(er,{direction:"horizontal",contentItems:c,selectedIdx:a,setSelectedIdx:l,pageBackgroundColor:e.pageBackgroundColor,feedPostUuid:e.feedPostUuid,canAddContent:!1}):null,[n,c,a,l,e.pageBackgroundColor,e.feedPostUuid]);e.editPreviewOptions&&C&&"node"===C.type&&C.backgroundColor&&(e.editPreviewOptions.pageBackgroundColor=(0,s.H0)(C.backgroundColor)??void 0);let{openEditPreviewModalCallback:T,deleteSelectedItemCallback:w}=e,[I,P]=o.useState(!1),y=o.useMemo(()=>{if(!T&&!w||!I||!C)return null;let e=n?"feed_post_content--editPreviewOverlayWithThumbnails--pPLEV feed_post_content--editPreviewOverlay--GYr8Q":"feed_post_content--editPreviewOverlay--GYr8Q";return o.createElement("div",{className:e},C&&(0,h.aT)(C)&&T&&o.createElement("div",null,o.createElement("button",{onClick:T,className:"feed_post_content--editPreviewButton--Z9MT5"},(0,f.tx)("fig_feed.edit_preview"))),w&&o.createElement(u.B,{svg:$.A,className:"feed_post_content--deleteContentItemIcon--XF-w3",onClick:w,autosize:!0,"data-tooltip-type":g.Ib.TEXT,"data-tooltip":(0,f.t)("fig_feed.delete"),dataTestId:"delete-content-item"}))},[I,C,n,T,w]);return o.createElement("div",{className:r()("feed_post_content--contentSectionContainer--KsA0H",t&&"feed_post_content--showOverflow--LCCb8")},o.createElement("div",{ref:_,className:n&&!t?"feed_post_content--selectedContentWithThumbnails--OrAWq feed_post_content--selectedContent--pGcQE":"feed_post_content--selectedContent--pGcQE",style:{backgroundColor:(0,v.m)(C,e.pageBackgroundColor)},onMouseDown:e.onSelectedTileMouseDown,role:"button",tabIndex:0,onPointerEnter:()=>P(!0),onPointerLeave:()=>P(!1),"data-testid":"feed-post-content-section"},y,o.createElement(m.x,{isLoading:!C},()=>e.staticContent?o.createElement(ea,{content:C,isThumbnail:!1,feedPostUuid:e.feedPostUuid,feedPostIdx:e.feedPostIdx,source:e.source}):o.createElement(eo,{contentItems:c.filter(e=>null!==e),selectedIdx:a,editPreviewOptions:e.editPreviewOptions,feedPostUuid:e.feedPostUuid,pageBackgroundColor:i,source:e.source}))),b)}function er(e){let t=o.useRef(null);o.useEffect(()=>{let n=t.current,o=t.current?.children[e.selectedIdx];if(!n||!o)return;let a=n?.getBoundingClientRect();a?.top>=0&&a?.left>=0&&a?.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a?.right<=(window.innerWidth||document.documentElement.clientWidth)&&o.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})},[e.direction,e.selectedIdx]);let n=function(){let e=(0,P.fp)(N)[0];return o.useCallback(t=>{e&&e.ref?.current&&(t&&t!==e?.feedPostUuid||e.ref?.current.pause())},[e])}(),{scrollToItem:a,onReorderCallback:i,setSelectedIdx:s,deleteItem:d}=e,[c,m]=o.useState(null),f=e.thumbnailType||"wide",_=o.useCallback((t,i,l)=>{let u=r()(z,l&&"feed_post_content--selectedThumbnail--MdH-d","small"===f&&W,"wide"===f&&Y);return o.createElement("div",{className:u,onMouseDown:()=>{n(e.feedPostUuid),a?.(i),s?.(i)},onPointerEnter:()=>m(i),onPointerLeave:()=>m(null),role:"button",tabIndex:0,style:{backgroundColor:(0,v.m)(t,e.pageBackgroundColor)},"data-testid":`content-item-${i}`},o.createElement(ea,{content:t,isThumbnail:!0,isEditing:e.isEditing}),d&&i===c&&o.createElement("div",{className:"feed_post_content--thumbnailOverlay--feEzZ"},o.createElement("div",{className:"feed_post_content--deleteIcon--ptC6G",onClick:e=>{e.stopPropagation(),d(i)},role:"button",tabIndex:0},o.createElement(C,null))))},[e.pageBackgroundColor,e.feedPostUuid,f,e.isEditing,c,n,a,s,d]),h=t=>{if("horizontal"!==e.direction)return null;let n=e.selectedIdx===("left"===t?0:e.contentItems.length-1);return o.createElement(p.$,{onMouseDown:()=>{let n=(e.selectedIdx+("left"===t?-1:1)+e.contentItems.length)%e.contentItems.length;s?.(n)},icon:"left"===t?"chevron-left-32":"chevron-right-32",variant:"text",disabled:n})},g=r()("feed_post_content--contentThumbnailsSectionV2--dXne6","horizontal"===e.direction?"feed_post_content--contentThumbnailsSectionV2_horizontal--mE1uH":"feed_post_content--contentThumbnailsSectionV2_vertical--xycdu");if(i)return o.createElement("div",{className:g},o.createElement(l._.Group,{axis:"vertical"===e.direction?"y":"x",onReorder:i,values:e.contentItems,className:r()(V,"horizontal"===e.direction?"feed_post_content--contentThumbnailsSectionInnerV2_horizontalReorder--icuQg":Z),role:"button",tabIndex:0,ref:t},e.contentItems.map((t,n)=>o.createElement(l._.Item,{value:t,id:J(t),key:J(t),translate:"no"},_(t,n,!(e.canAddContent&&e.isAddingContent)&&n===e.selectedIdx))),e.canAddContent&&o.createElement("div",{className:r()(z,"small"===e.thumbnailType&&W,"wide"===e.thumbnailType&&Y,e.isAddingContent?"feed_post_content--addingActive--h51xM":"feed_post_content--plusIcon--QHfa6"),onMouseDown:e.setAddingActive,role:"button",tabIndex:0},o.createElement(u.B,{svg:G.A}))));{let n=r()(V,"horizontal"===e.direction?"feed_post_content--contentThumbnailsSectionInnerV2_horizontal--r0SNN":Z);return o.createElement("div",{className:g},h("left"),o.createElement("div",{className:n,ref:t},e.contentItems.map((t,n)=>o.createElement(o.Fragment,{key:n},_(t,n,n===e.selectedIdx)))),h("right"))}}},355739:(e,t,n)=>{n.d(t,{K:()=>ew});var o=n(848318),a=n(301168),i=n(660376),r=n(536384),l=n.n(r),s=n(989232),d=n(637640),c=n(865114),m=n(857607),u=n(720300),f=n(410725),p=n(304756),_=n(710044),h=n(755534),g=n(720522),E=n(66699),v=n(314979),C=n(967688),b=n(912873),T=n(847461),w=n(453370),I=n(31898),P=n(170954),y=n(412865),k=n(466747),x=n(257270),U=n(180294),M=n(209595),O=n(125761),N=n(55116),L=n(765330),S=n(983912),A=n(17753),D=n(901176),R=n(446951),B=n(837988),F=n(257264);let H="feed_post_detail_modal_opened",V=(0,F.Op)({initial:"await_open_feed_post_detail_modal",states:[{id:"await_open_feed_post_detail_modal",transitions:[(0,F.nr)(H,"complete")]},{id:"complete",terminal:!0}]}),Z=(0,F.rn)("open_feed_post_detail_modal",V);var z=n(426459),W=n(34542),Y=n(265098),G=n(752181),$=n(263336),J=n(18584),Q=n(133318),j=n(264478),K=n(863270),X=n(704410),q=n(160674),ee=n(809086),et=n(821527),en=n(45121);function eo(e){let t=o.useRef(null),[n,a]=o.useState({width:0,height:0});o.useLayoutEffect(()=>{if(t.current){let e=t.current.getBoundingClientRect();a({width:e.width,height:e.height})}},[a]);let i=e.width,r=e.backgroundColor,l="light"===e.background,s=(0,q.xT)(e.targetKey)||document.documentElement;if(!s)return null;let d=o.createElement(Q.Jn,{useOriginalSrcFills_DEPRECATED:!0,className:ee._S,onClick:e.dismissModal,innerText:"close",svg:l?et.default:en.A}),c=o.createElement("div",null,e.ctaText&&e.onClickPrimaryCta&&o.createElement("div",{className:ee.ZA},e.bottomLeftText&&o.createElement("b",null,e.bottomLeftText),o.createElement("div",{className:ee.OQ},e.secondaryCtaText&&e.onClickSecondaryCta&&o.createElement(K.$z,{className:l?ee.jS:ee.dC,onClick:e.onClickSecondaryCta,"aria-hidden":!0},e.secondaryCtaText),e.ctaText&&e.onClickPrimaryCta&&o.createElement(j.vd,{className:l?ee.TI:ee.ZO,onClick:e.onClickPrimaryCta,trackingProperties:e.buttonContext?{buttonContext:e.buttonContext}:void 0},e.ctaText)))),m=function(e,t,n,o,a){let i=a??0;switch(o){case X.LN.BOTTOM_LEFT:return{top:e.bottom-(n+i),left:e.left+i};case X.LN.BOTTOM_RIGHT:return{top:e.bottom-(n+i),left:e.right-(t+i)};case X.LN.TOP_RIGHT:return{top:e.top+i,left:e.right-(t+i)};case X.LN.CENTER:return{top:e.top+(e.height-n)/2,left:e.left+(e.width-t)/2};default:return{top:e.top+i,left:e.left+i}}}(s.getBoundingClientRect(),n.width,n.height,e.modalLocation,e.positionOffset);return o.createElement("div",{className:l?ee.IL:ee.wV,ref:t,style:{backgroundColor:r,width:i,...m}},o.createElement("div",null,o.createElement("h1",null,e.title),e.children,d),c)}var ea=n(136169);let ei="feed-post-detail-modal";function er(){let e=(0,W.e)({overlay:ea.bIZ,priority:$.N.DEFAULT_MODAL}),t=(0,Y.zl)(Z),n=o.useMemo(()=>(0,C.tx)("rcs.feed_onboarding.zoom_pan.title"),[]),a=!!(0,G.f)("has_seen_feed_post_details_zoom_pan_nudge");(0,o.useEffect)(()=>{!a&&t.completed&&e.show()},[e,a,t]);let i=(0,o.useMemo)(()=>o.createElement(z.S,{shortcut:"\u2318\xb1"}),[]),r=(0,o.useMemo)(()=>o.createElement(z.S,{shortcut:"Ctrl\xb1"}),[]);return o.createElement(J.h,{modalType:X.q3.SELF_CONTAINED,element:(0,o.useCallback)(e=>o.createElement(eo,{targetKey:ei,dismissModal:e.dismissModal,title:n,ctaText:(0,C.t)("rcs.got_it"),onClickPrimaryCta:e.onClickPrimaryCta,width:268,modalLocation:X.LN.BOTTOM_LEFT,positionOffset:16},o.createElement("p",null,(0,C.tx)("rcs.feed_onboarding.zoom_pan.content",{macKeyboardShortcut:i,windowsKeyboardShortcut:r}))),[n,i,r]),trackingContextName:"Feed Post Details View Zoom Pan Nudge",isShowing:e.isShowing,onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete,userFlagOnShow:"has_seen_feed_post_details_zoom_pan_nudge"})}var el=n(482663),es=n(387594),ed=n(414607),ec=n(524767),em=n(483337),eu=n(983894),ef=n(311139),ep=n(809651),e_=n(378244),eh=n(298944);let eg="feed_post_detail_modal--detailModal--MMYKj",eE="feed_post_detail_modal--headerSvg--9mFA0";var ev=n(889438),eC=n(628015),eb=n(744239);function eT(){return o.createElement("div",null,(0,C.t)("fig_feed.post_dne"))}let ew=(0,R.Ju)(function(e){let t=(0,a.wA)(),n=(0,U.dq)(),r=(0,M._6)();o.useEffect(()=>{"teamFeed"!==r.view&&"user"!==r.view&&("fullscreen"===r.view&&e.inFileView||t(I.Ce()))},[t,r,e.inFileView]);let l=o.useRef({selectedView:r,inFileView:e.inFileView});o.useEffect(()=>{l.current={selectedView:r,inFileView:e.inFileView}},[e.inFileView,r]),o.useEffect(()=>()=>{l.current.inFileView||"teamFeed"!==l.current.selectedView.view||t(w.$T({...l.current.selectedView,postUuid:void 0}))},[t]);let u=o.useRef(!1),_=o.useCallback(t=>{u.current||!t||e.autofocusCommentInput||(t.focus(),u.current=!0)},[e.autofocusCommentInput]),h=(0,c.ZC)(e.postUuid);o.useEffect(()=>{n&&(e.inFileView||h===e.postUuid||"teamFeed"!==r.view||(u.current=!1,d.Ay.replace((0,ec.Kc)(n,{uuid:e.postUuid}))))},[h,e.postUuid,n,e.inFileView,r]);let g=(0,f.Rs)(N.FHz,{publicUuid:e.postUuid});o.useEffect(()=>{!e.inFileView&&g.data?.feedPost?.title&&(0,x.hL)(g.data.feedPost.title)},[e.inFileView,g.data]),o.useEffect(()=>((0,s.trackEvent)("Team Feed Post Details View Visited",{postUuid:e.postUuid}),()=>{(0,s.trackEvent)("Team Feed Post Closed",{postUuid:e.postUuid})}),[e.postUuid]),o.useEffect(()=>{p.Ay.post(`/api/feed_posts/${e.postUuid}/mark_viewed`)},[e.postUuid]);let[b,T]=o.useState(0);o.useEffect(()=>{T(e.selectedContentIdx||0)},[e.postUuid,e.selectedContentIdx]);let P=o.useMemo(()=>g.data?.feedPost?g.data.feedPost.content.map(e=>JSON.parse(e)):[],[g.data]),y=P.length,{requestToOpenPostByFeedIdx:k}=e,O=o.useCallback(t=>{t.keyCode===m.Uz.LEFT_ARROW?0===b?k&&void 0!==e.feedIdx&&k(e.feedIdx-1):T(b-1):t.keyCode===m.Uz.RIGHT_ARROW&&(b===y-1?k&&void 0!==e.feedIdx&&k(e.feedIdx+1):T(b+1))},[b,y,k,e.feedIdx]),[L,A]=o.useState(!0),D=o.useCallback(()=>A(e=>!e),[]),[R,F]=o.useState(!1);o.useEffect(()=>{!R&&"loaded"===g.status&&P[b]&&(0,S.Dr)(P[b])&&((0,E.YQ)({id:H}),F(!0))},[g.status,R,P,b]);let V=g.data?.feedPost||e.initialPreloadedPost;if(!V)switch(g.status){case"errors":return o.createElement(eT,null);case"loading":return o.createElement(ed.aF,{className:eg,size:"any"});case"loaded":return t(v.s.error((0,C.t)("fig_feed.post_dne"))),t(I.Ce()),null;default:(0,i.xb)(g)}return o.createElement(o.Fragment,null,o.createElement(ed.aF,{className:eg,size:"any"},o.createElement("div",{className:"feed_post_detail_modal--layout--b28Tm",role:"listbox",tabIndex:0,onKeyDown:O,ref:_},o.createElement("div",{className:"feed_post_detail_modal--container--PkjxH","data-onboarding-key":ei},o.createElement("div",{className:L?"feed_post_detail_modal--contentContainer--HvXHM":"feed_post_detail_modal--contentContainerFull--Y-lEo feed_post_detail_modal--contentContainer--HvXHM"},o.createElement(em.x,{contentItems:P,staticContent:!1,selectedContentIdx:b,setSelectedContentIdx:t=>{T(t),e.onSetSelectedContentIdx?.(t)},pageBackgroundColor:V.backgroundColor??void 0,feedPostUuid:e.postUuid,source:ec.Zp.DETAIL_MODAL})),o.createElement(eI,{feedPost:V,contentItems:P,autofocusCommentInput:!!e.autofocusCommentInput,inFileView:e.inFileView,onSidebarToggle:D,show:L})))),o.createElement(B.p,null,o.createElement(er,null)))},k.E,R.ZU.YES);function eI(e){let t=(0,a.wA)(),n=(0,O.iZ)(),i=(0,U.dq)(),r=o.useCallback(()=>{t(I.Ce())},[t]),{fileData:l,fileIcon:s,fileLoaded:d,openFile:c}=(0,ec.rS)(e.feedPost.publicUuid,e.contentItems,e.feedPost.fileKey),m=(0,ec.DG)(e.feedPost.publicUuid,ec.dy.DETAIL);if(!i||!n)return null;let u=o.createElement(o.Fragment,null,o.createElement("div",{className:"feed_post_detail_modal--headerContextMenu--0idb0"},o.createElement(eh.Wu,{feedPost:e.feedPost,source:ec.Zp.DETAIL_MODAL})),o.createElement("button",{onClick:m,"data-tooltip-type":A.Ib.TEXT,"data-tooltip":(0,C.t)("fig_feed.copy_link_to_post")},o.createElement(g.B,{svg:eb.A,className:eE})),o.createElement("button",{onClick:e.onSidebarToggle},o.createElement(g.B,{svg:eC.A,className:eE})),o.createElement("button",{onClick:r},o.createElement(g.B,{svg:et.default,className:"feed_post_detail_modal--closeX--NwlcU"})));if(!e.show)return o.createElement("div",{className:"feed_post_detail_modal--sidebarCollapsed--JYqsn feed_post_detail_modal--contentOverlayPill--1jsoj"},u);let f=o.createElement("div",{className:"feed_post_detail_modal--headerContainer--oByFt"},o.createElement("div",{className:"feed_post_detail_modal--headerTitle--SJpLy"},(0,C.tx)("fig_feed.details")),o.createElement("div",{className:"feed_post_detail_modal--headerRight--VNHRM","data-testid":"feed-modal-open-file"},u)),p=o.createElement("div",{className:"feed_post_detail_modal--infoContainer--r-tGh"},o.createElement("div",{className:"feed_post_detail_modal--topRow--Rs14r"},o.createElement(ef.B,{user:e.feedPost.creator,date:e.feedPost.createdAt,size:b.Pf.MEDIUM,shortDate:!1})),o.createElement(ey,{feedPost:e.feedPost,currentOrgId:i,currentUser:n}),d&&!e.inFileView&&o.createElement("button",{className:"feed_post_detail_modal--fileInfo--IsxWn",onClick:e.inFileView?void 0:c},(0,C.tx)("fig_feed.from_file",{fileComponent:o.createElement(o.Fragment,null,o.createElement(_.MW,{className:"feed_post_detail_modal--detailsFileButtonIcon--wfORW",type:s,size:_.LE.SMALL}),o.createElement("span",{className:"feed_post_detail_modal--detailsFileButtonName--kqizR"},l.name))})),o.createElement("div",{className:"feed_post_detail_modal--bottomRow--ycO1b"},o.createElement(ep.Q$,{type:ep.Us.FULL,source:ep.zY.DETAIL_POST,postUuid:e.feedPost.publicUuid,postId:e.feedPost.id,feedReactions:e.feedPost.reactions})));return o.createElement("div",{className:"feed_post_detail_modal--rightSideContainer--n9eWy"},f,o.createElement(eP,{postInfo:p,comments:e.feedPost.comments,postUuid:e.feedPost.publicUuid,currentUser:n,currentOrgId:i,autofocusCommentInput:e.autofocusCommentInput}))}function eP(e){let t=(0,a.wA)(),n=o.useRef(null),i=o.useRef(null),[r,l]=o.useState(!1),s=o.useCallback(t=>{0===t.intersectionRatio&&e.comments.length>0?l(!0):l(!1)},[e.comments.length]);(0,el.g)(i,s,{threshold:[0,1]});let d=o.useCallback(()=>{n.current&&n.current.scrollToBottom()},[]),c=e.comments.sort((e,t)=>e.createdAt.getTime()-t.createdAt.getTime()),[m,f]=o.useState(e.comments.length);o.useEffect(()=>{let t=m<e.comments.length;t&&f(e.comments.length);let n=e.comments[e.comments.length-1];t&&n.user.id===e.currentUser.id&&d()},[m,e.comments,e.currentUser,d]);let[p,_]=o.useState([]),E=(0,a.d4)(e=>e.comments.newComment),v=o.useCallback(()=>{t(P.gX({postUuid:e.postUuid,messageMeta:p,attachmentIds:Object.keys(E.attachments)})),_([]),t(T.$M({resetStatusOnly:!1}))},[t,e.postUuid,p,E]),w=o.useMemo(()=>({library:new L.M8(e.currentOrgId,e.postUuid)}),[e.currentOrgId,e.postUuid]),I=o.useCallback(e=>{t(T.nb({attachmentId:e.id,attachment:e}))},[t]),k=o.useCallback((e,n)=>{t(T.nb({attachmentId:e,attachment:null})),n?n.then(()=>D.J.delete(e)):D.J.delete(e)},[t]);return o.createElement("div",{className:"feed_post_detail_modal--commentSection--2SXbE"},o.createElement(h.P,{innerClassName:"feed_post_detail_modal--commentSectionScroll--yFbDD",useBottomPinning:!0,ref:n},e.postInfo,o.createElement("div",{ref:i,className:"feed_post_detail_modal--existingComments--1ORWZ"},c.map(t=>o.createElement(eu.i,{key:t.id,attachments:t.attachments,commentId:t.id,commentUser:t.user,commentUuid:t.uuid||"",createdAt:t.createdAt,currentOrgId:e.currentOrgId,mentionables:w,messageMeta:(0,y.o8)(t.messageMeta),reactions:t.reactions,user:e.currentUser}))),r&&o.createElement("div",{className:"feed_post_detail_modal--commentsToast--nTd74",onClick:d,role:"button",tabIndex:0},o.createElement(g.B,{svg:ev.A,className:"feed_post_detail_modal--arrowDown--XpvZj"}),(0,C.tx)("fig_feed.num_comments",{numComments:c.length}))),o.createElement("div",{className:"feed_post_detail_modal--composerContainer--bIZJV"},o.createElement("div",{className:"feed_post_detail_modal--composerAvatar--4cjv3"},o.createElement(b.H8,{user:e.currentUser,size:b.Pf.MEDIUM})),o.createElement(e_.o,{attachments:Object.values(E.attachments),autofocus:e.autofocusCommentInput,composerContainerClass:"feed_post_detail_modal--composer--A7iTJ thread_comment_composer--inputSectionWrapper--Bxyab",currentOrgId:e.currentOrgId,deleteAttachment:k,editableTypeaheadClass:"feed_post_detail_modal--editableTypeahead--4ZMRF thread_comment_composer--editableTypeahead--9R6Yd text--fontPos13--xW8hS text--_fontBase--QdLsd",editingExistingComment:!1,errorFallback:u.H4.NONE,fallback:null,hideSubmitButton:!1,mentionables:w,messageContent:p,onSubmit:v,updateAttachment:I,updateMessage:_,user:e.currentUser})))}function ey(e){let t=o.useMemo(()=>(0,y.o8)(e.feedPost.descriptionMeta),[e.feedPost.descriptionMeta]);return o.createElement("div",{role:"textbox",tabIndex:0,className:"feed_post_detail_modal--postDescription--9xUac"},o.createElement("div",{className:"feed_post_detail_modal--postTitle--dZdnT feed_tile--postTitle--DY-Hh"},e.feedPost.title),o.createElement(es.HH,{messageMeta:t,commentId:e.feedPost.id,className:l()("feed_post_detail_modal--postDescriptionMessage--vHcLD comment_message--commentMessage--kZCzD")}))}},983894:(e,t,n)=>{n.d(t,{i:()=>b});var o=n(848318),a=n(301168),i=n(459633),r=n(720300),l=n(156974),s=n(967688),d=n(912873),c=n(847461),m=n(31898),u=n(170954),f=n(711332),p=n(841951),_=n(387594),h=n(975796),g=n(271762),E=n(311139),v=n(809651),C=n(378244);function b(e){let t=(0,a.wA)(),[n,l]=(0,i.M)(),[s,m]=o.useState([]);o.useEffect(()=>{m(e.messageMeta)},[e.messageMeta]);let[f,h]=o.useState(!1),g=(0,a.d4)(e=>e.comments.editingComment),b=o.useCallback(n=>{t(c.uy({id:e.commentId,key:e.commentUuid,attachmentId:n.id,attachment:n}))},[t,e.commentId,e.commentUuid]),w=o.useCallback(n=>(t(c.uy({id:e.commentId,key:e.commentUuid,attachmentId:n,attachment:null})),Promise.resolve()),[e.commentId,e.commentUuid,t]),I=o.useCallback(()=>{t(u.cx({commentId:e.commentId,uuid:e.commentUuid,messageMeta:s,attachmentUpdates:g?.attachmentUpdates})),t(c.cL()),h(!1)},[t,g,e.commentId,e.commentUuid,s]),P=o.useCallback(()=>{let n={};e.attachments?.forEach(e=>{n[e.id]=e}),t(c.Df({id:e.commentId,key:e.commentUuid,messageMeta:e.messageMeta,attachmentUpdates:{deleted:[],attachments:n}})),h(!0)},[t,e.commentId,e.commentUuid,e.messageMeta,e.attachments]),y=o.useCallback(()=>{m(e.messageMeta),t(c.pD()),h(!1)},[t,e.messageMeta]),k=e.commentUser.id===e.user.id,x=e.commentId.startsWith(u.v6),U=e.reactions.length>0;return o.createElement("div",{className:"feed_post_details_comments--comment--ScdJc",ref:n},o.createElement("div",{className:"feed_post_details_comments--avatarColumn--13o7f"},o.createElement(E.A,{user:e.commentUser,noHandle:!0,size:d.Pf.MEDIUM})),o.createElement("div",{className:"feed_post_details_comments--commentBody--tIA5q"},o.createElement("div",{className:"feed_post_details_comments--commentHeader--vzA-X"},o.createElement(E.B,{user:e.commentUser,date:e.createdAt,noAvatar:!0,shortDate:!0}),!f&&k&&o.createElement(T,{commentId:e.commentId,commentUuid:e.commentUuid,user:e.user,onEdit:P,hideTarget:!l})),f?o.createElement("div",{className:"feed_post_details_comments--editComposerContainer--ePn76"},o.createElement(C.o,{attachments:g?.attachmentUpdates?.attachments?Object.values(g?.attachmentUpdates?.attachments):[],autofocus:!0,composerContainerClass:"feed_post_details_comments--composer--5EDPO thread_comment_composer--inputSectionWrapper--Bxyab",currentOrgId:e.currentOrgId,deleteAttachment:w,editableTypeaheadClass:"feed_post_details_comments--editableTypeahead--kMhTQ thread_comment_composer--editableTypeahead--9R6Yd text--fontPos13--xW8hS text--_fontBase--QdLsd",editingExistingComment:!0,errorFallback:r.H4.NONE,fallback:r.H4.NONE,hideSubmitButton:!1,mentionables:e.mentionables,messageContent:s,onCancel:y,onSubmit:I,updateAttachment:b,updateMessage:m,user:e.user})):o.createElement(o.Fragment,null,o.createElement("div",{className:"feed_post_details_comments--commentRow--c2So7"},o.createElement(_.HH,{messageMeta:s,commentId:e.commentId,className:"feed_post_details_comments--commentMessage--lHCM2"}),!x&&!U&&o.createElement(v.nn,{type:v.Us.ADD_ONLY,source:v.zY.DETAIL_COMMENT_NO_REACTION,feedReactions:e.reactions,commentId:e.commentId,commentUuid:e.commentUuid,hideAddReactionButton:!l})),e.attachments&&o.createElement("div",{className:"feed_post_details_comments--attachmentsContainer--M-F-r"},o.createElement(p.a,{attachments:e.attachments,canEdit:k,fileKey:""})),U&&o.createElement(v.nn,{type:v.Us.FULL,source:v.zY.DETAIL_COMMENT_WITH_REACTION,feedReactions:e.reactions,commentId:e.commentId,commentUuid:e.commentUuid,hideAddReactionButton:!l}))))}function T(e){let t=(0,a.wA)(),n=o.useCallback(()=>{t((0,m.to)({type:f.h,data:{onConfirm:()=>{t(u.BC({commentId:e.commentId,uuid:e.commentUuid}))},popStack:!0},showModalsBeneath:!0}))},[t,e.commentId,e.commentUuid]),{onEdit:i}=e,r=o.useMemo(()=>[o.createElement(l.c$,{onClick:i,key:"edit"},(0,s.tx)("comments.edit")),o.createElement(l.c$,{onClick:n,key:"delete"},(0,s.tx)("comments.delete_comment"))],[n,i]);return e.commentId.startsWith(u.v6)?null:o.createElement(g.V,{hideTarget:e.hideTarget,dropdownId:(0,h.K)(e.commentId),options:r,lean:"left"})}},311139:(e,t,n)=>{n.d(t,{A:()=>_,B:()=>p});var o=n(848318),a=n(301168),i=n(536384),r=n.n(i),l=n(720861),s=n(173926),d=n(912873),c=n(453370),m=n(67188),u=n(493571);let f="feed_profile_header--profile--BBFn9";function p(e){let t=e.date&&o.createElement(s.h1,{date:e.date,style:e.shortDate?"short":void 0,capitalize:!0,key:"from-now"}),n=[o.createElement("div",{key:"from-now",onMouseDown:e.onTileMouseDown,role:"button",tabIndex:0,className:r()(e.onTileMouseDown&&"feed_profile_header--fromNowLinkContainer--wSTrC","feed_profile_header--fromNow--JI-v6")},t)];return o.createElement("div",{className:f},o.createElement(_,{user:e.user,size:e.size,noAvatar:e.noAvatar,noHandle:e.noHandle,appendToHandle:n}))}function _(e){let t=(0,a.wA)(),n=o.useCallback(n=>{n.stopPropagation(),e.user.id&&t(c.$T({view:"user",userId:e.user.id,userViewTab:u.o.INTERNAL_PROFILE_POSTS}))},[t,e.user.id]),i=e.appendToHandle||!1===e.noHandle;return o.createElement("div",{className:f},!e.noAvatar&&o.createElement(l.N,{onClick:n,trusted:!0,onMouseDown:m.dG},o.createElement(d.H8,{user:e.user,size:e.size??d.Pf.LARGE})),i&&o.createElement("div",{className:"feed_profile_header--content--bTCE2"},!e.noHandle&&o.createElement(l.N,{className:"feed_profile_header--handleLink--GjGl1",onClick:n,trusted:!0},o.createElement("div",{className:"feed_profile_header--handle--CKDhH feed_profile_header--boldLinkText--MqQBP"},e.user.handle)),e.appendToHandle))}},378244:(e,t,n)=>{n.d(t,{o:()=>o});let o=(0,n(720300).kf)("lazy_feed_comment_composer",{isCodesplit:!0,ComponentFactory:async()=>({default:(await Promise.all([n.e(8658),n.e(5655),n.e(8854),n.e(8410)]).then(n.bind(n,600423))).FeedPostCommentComposer})})}}]);

//# debugId=135f8075-4165-5901-82fd-bace39f82a97

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/803fd116c740c1aa52b7f570c7ab4ed630c10efd/4372-64c495890f77e971.min.js.map